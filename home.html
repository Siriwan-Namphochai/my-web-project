<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Create Property</title>

  <!-- Stylesheets -->
  <link rel="stylesheet" href="Style/home.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
</head>

<body>
  <div class="layout">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="logo"></div>
      <nav>
        <ul>
          <li class="active"><i class="fa fa-home"></i> Properties</li>
          <li><i class="fa fa-users"></i> Members</li>
          <li><i class="fa fa-cog"></i> Settings</li>
          <li><i class="fa fa-bullhorn"></i> News & Activities</li>
          <li><i class="fa fa-gift"></i> Promotion</li>
        </ul>
      </nav>
    </aside>

    <!-- Main Layout -->
    <div class="main-layout">
      <header class="header">
        <div class="user-info">ad min (admin@gmail.com)</div>
      </header>

      <main class="content">
        <h1>Create Property</h1>
        <form class="form-grid">
          <!-- Left Column -->
          <div class="form-column">
            <h3>Details</h3>
            <label for="propertyNameTH">Property Name (TH)*</label>
            <input type="text" id="propertyNameTH" placeholder="Property Name (TH)" />

            <label for="propertyNameEN">Property Name (EN)*</label>
            <input type="text" id="propertyNameEN" placeholder="Property Name (EN)" />

            <label for="propertyType">Property Type</label>
            <input type="text" id="propertyType" placeholder="Property Type" />

            <label for="propertyCode">Property Code</label>
            <input type="text" id="propertyCode" placeholder="Property Code" />

            <label for="propertyGroup">Property Group*</label>
            <select id="propertyGroup">
              <option value="">Select Group</option>
              <option value="Group 1">Group 1</option>
              <option value="Group 2">Group 2</option>
            </select>

            <label for="about">About</label>
            <textarea id="about" rows="4" placeholder="About"></textarea>

            <label for="areaSize">Area Size</label>
            <input type="text" id="areaSize" placeholder="Area Size" />

            <label for="unitSize">Unit Size</label>
            <input type="text" id="unitSize" placeholder="Unit Size" />

            <label for="constructionBy">Construction By</label>
            <input type="text" id="constructionBy" placeholder="Construction By" />
          </div>

          <!-- Right Column -->
          <div class="form-column">
            <h3>Bank Account</h3>

            <label for="accountName">Account Name</label>
            <input type="text" id="accountName" placeholder="Account Name" />

            <label for="accountType">Account Type*</label>
            <select id="accountType">
              <option value="">Select Type</option>
              <option value="Savings">Savings</option>
              <option value="Current">Current</option>
            </select>

            <label for="bankName">Bank Name*</label>
            <select id="bankName">
              <option value="">Select Bank</option>
              <option value="Bank 1">Bank 1</option>
              <option value="Bank 2">Bank 2</option>
            </select>

            <label for="bankBranch">Bank Branch</label>
            <input type="text" id="bankBranch" placeholder="Bank Branch" />

            <label for="billerId">Biller ID</label>
            <input type="text" id="billerId" placeholder="Biller ID" />

            <div class="switch-group">
              <div class="switch-item">
                <label class="switch-label">Active</label>
                <label class="switch">
                  <input type="checkbox" id="active">
                  <span class="slider"></span>
                </label>
              </div>

            <div class="switch-item">
                <label class="switch-label">Fund Account</label>
                <label class="switch">
                  <input type="checkbox" id="fundAccount">
                  <span class="slider"></span>
                </label>
  </div>
</div>

          </div>
        </form>

        <!-- Buttons -->
        <div class="form-buttons">
          <button type="button" class="btn-cancel">Cancel</button>
          <button type="submit" class="btn-submit">Submit</button>
        </div>
      </main>
    </div>
  </div>

  <!-- Firebase Script (v12 Modular) -->
  <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
  import { getDatabase, ref, push, set } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAq7rHIZMiVMOEFiDa6uohhjhFtRZFJypc",
    authDomain: "my-demo-project-27c29.firebaseapp.com",
    databaseURL: "https://my-demo-project-27c29-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "my-demo-project-27c29",
    storageBucket: "my-demo-project-27c29.appspot.com",
    messagingSenderId: "841978784478",
    appId: "1:841978784478:web:a31a537d952b08a33c304f"
  };

  const app = initializeApp(firebaseConfig);
  const database = getDatabase(app);

  document.querySelector(".btn-submit").addEventListener("click", async function (e) {
    e.preventDefault();

    const nameTH = document.getElementById("propertyNameTH").value.trim();
    const nameEN = document.getElementById("propertyNameEN").value.trim();
    const propertyType = document.getElementById("propertyType").value.trim();
    const propertyCode = document.getElementById("propertyCode").value.trim();
    const propertyGroup = document.getElementById("propertyGroup").value.trim();
    const about = document.getElementById("about").value.trim();
    const areaSize = document.getElementById("areaSize").value.trim();
    const unitSize = document.getElementById("unitSize").value.trim();
    const constructionBy = document.getElementById("constructionBy").value.trim();
    const accountName = document.getElementById("accountName").value.trim();
    const accountType = document.getElementById("accountType").value;
    const bankName = document.getElementById("bankName").value;
    const bankBranch = document.getElementById("bankBranch").value.trim();
    const billerId = document.getElementById("billerId").value.trim();
    const active = document.getElementById("active").checked;
    const fundAccount = document.getElementById("fundAccount").checked;

    if (!nameTH || !nameEN) {
      alert("กรุณากรอก Property Name ทั้งภาษาไทยและภาษาอังกฤษ");
      return;
    }

    if (!propertyCode) {
      alert("กรุณากรอก Property Code");
      return;
    }

    const createdAt = new Date().toISOString();

    const detailData = {
      nameTH,
      nameEN,
      propertyType,
      propertyCode,
      propertyGroup,
      about,
      areaSize,
      unitSize,
      constructionBy,
      createdAt
    };

    const bank_accountData = {
      accountName,
      accountType,
      bankName,
      bankBranch,
      billerId,
      active,
      fundAccount,
      createdAt
    };

    try {
      // Create new refs
      const detailRef = push(ref(database, "Details"));
      const bankRef = push(ref(database, "Bank Account"));

      // Save both in parallel
      await Promise.all([
        set(detailRef, detailData),
        set(bankRef, bank_accountData)
      ]);

      alert("บันทึกข้อมูลสำเร็จ");
      document.querySelector("form.form-grid").reset();

    } catch (error) {
      alert("เกิดข้อผิดพลาด: " + error.message);
    }
  });
</script>
</body>
</html>
